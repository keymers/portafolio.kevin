---
// Layout principal del portfolio
import EnvScript from "../components/EnvScript.astro";
import Analytics from "@vercel/analytics/astro";

interface Props {
	title: string;
	description?: string;
	image?: string;
	canonicalURL?: string;
	faqData?: Array<{ question: string; answer: string }>;
}

const { 
	title, 
	description = "Desarrollo web profesional y soluciones inform치ticas. Creamos landing pages econ칩micas, sitios web modernos y tiendas online baratas para impulsar tu negocio. 춰Cotiza tu p치gina web gratis!",
	image = "/og-image.jpg",
	canonicalURL = new URL(Astro.url.pathname, Astro.site).toString(),
	faqData = null
} = Astro.props;

const siteName = "Peko's Desarrollo Web";
---

<!doctype html>
<html lang="es">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<meta name="google-site-verification" content="RR1ju296aWWgFLL6L_b1mp9ZBEDRWufxvm4qsrNf2LI" />
		
		<!-- SEO Primario -->
		<title>{title}</title>
		<meta name="title" content={title} />
		<meta name="description" content={description} />
		<link rel="canonical" href={canonicalURL} />
		<meta
			name="keywords"
			content="hacer mi pagina web, soluciones informaticas, desarrollo web chile, dise침o web profesional, crear sitio web, landing page para mi negocio, programador web, servicios informaticos"
		/>
		<meta name="author" content="Kevin Joseph Gonz치lez Lister" />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={Astro.url} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={new URL(image, Astro.url)} />
		<meta property="og:site_name" content={siteName} />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={Astro.url} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content={new URL(image, Astro.url)} />

		<link rel="icon" type="image/svg+xml" href="/logo.svg" />

		<!-- JSON-LD Datos Estructurados -->
		<script type="application/ld+json" is:inline set:html={JSON.stringify({
			"@context": "https://schema.org",
			"@type": "ProfessionalService",
			"name": "Peko's Desarrollo Web",
			"image": "https://pekos.cl/og-image.jpg",
			"@id": "https://pekos.cl",
			"url": "https://pekos.cl",
			"telephone": "+56973650208",
			"priceRange": "$",
			"address": {
				"@type": "PostalAddress",
				"addressCountry": "CL"
			},
			"geo": {
				"@type": "GeoCoordinates",
				"latitude": -39.8172,
				"longitude": -73.2332
			},
			"openingHoursSpecification": {
				"@type": "OpeningHoursSpecification",
				"dayOfWeek": [
					"Monday",
					"Tuesday",
					"Wednesday",
					"Thursday",
					"Friday"
				],
				"opens": "09:00",
				"closes": "20:00"
			},
			"sameAs": [
				"https://wa.me/56973650208"
			]
		})}>
		</script>

		{faqData && (
			<script type="application/ld+json" is:inline set:html={JSON.stringify({
				"@context": "https://schema.org",
				"@type": "FAQPage",
				"mainEntity": faqData.map(item => ({
					"@type": "Question",
					"name": item.question,
					"acceptedAnswer": {
						"@type": "Answer",
						"text": item.answer
					}
				}))
			})}>
			</script>
		)}

		<!-- Performance optimization hints -->
		<link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link rel="dns-prefetch" href="https://stdnpttjitpyizbkjquc.supabase.co" />

		<!-- 游 OPTIMIZACI칍N: DNS prefetch para recursos Astro -->
		<link rel="dns-prefetch" href="/_astro/" />

		<!-- 游 OPTIMIZACI칍N: Preload scripts de Lottie -->
		<link
			rel="preload"
			href="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.5/dist/dotlottie-wc.js"
			as="script"
			crossorigin
		/>
		<link rel="preconnect" href="https://unpkg.com" />
		<link rel="preconnect" href="https://lottie.host" />

		<meta name="generator" content={Astro.generator} />

		<!-- 游 OPTIMIZACI칍N: Meta tags para mejor priorizaci칩n de recursos -->
		<meta http-equiv="x-dns-prefetch-control" content="on" />
		<link
			rel="preload"
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
			as="style"
			onload="this.onload=null;this.rel='stylesheet'"
		/>
		<noscript>
			<link
				href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
				rel="stylesheet"
			/>
		</noscript>
		<EnvScript />

		<!-- EmailJS Script -->
		<script type="text/javascript" src="/email.min.js" defer></script>
		<script type="text/javascript">
			document.addEventListener("DOMContentLoaded", function () {
				const checkEmailJS = () => {
					if (typeof window !== "undefined" && window.emailjs) {
						const publicKey = window.VITE_EMAILJS_PUBLIC_KEY;
						if (publicKey && publicKey !== "your_public_key" && publicKey !== "public_key_xxxxxxx") {
							window.emailjs.init(publicKey);
						}
					} else {
						setTimeout(checkEmailJS, 100);
					}
				};
				checkEmailJS();
			});
		</script>
	</head>
	<body class="bg-primary text-white min-h-screen relative overflow-x-hidden">
		{/* Fondo personalizado */}
		<div class="fixed inset-0 -z-10 fondo-chipset"></div>

		<slot />
		<!-- <Analytics /> -->
	</body>
</html>

<style is:global>
	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}

	body {
		font-family:
			"Inter",
			system-ui,
			-apple-system,
			BlinkMacSystemFont,
			"Segoe UI",
			Roboto,
			Oxygen,
			Ubuntu,
			Cantarell,
			"Open Sans",
			"Helvetica Neue",
			sans-serif;
	}

	.fondo-chipset {
		width: 100vw;
		height: 100vh;
		background: radial-gradient(
			ellipse at 60% 40%,
			#232946 60%,
			#0f172a 100%
		);
		position: fixed;
		top: 0;
		left: 0;
		z-index: -10;
		overflow: hidden;
	}
	.fondo-chipset::before {
		content: "";
		position: absolute;
		inset: 0;
		background:
			radial-gradient(circle at 20% 30%, #3b82f6 0%, transparent 60%),
			radial-gradient(circle at 80% 70%, #e11d74 0%, transparent 60%),
			radial-gradient(circle at 50% 90%, #3b82f6 0%, transparent 70%),
			radial-gradient(circle at 70% 20%, #e11d74 0%, transparent 70%);
		opacity: 0.25;
		pointer-events: none;
		z-index: 1;
	}
	.fondo-chipset::after {
		content: "";
		position: absolute;
		inset: 0;
		background-image:
			repeating-linear-gradient(
				120deg,
				rgba(59, 130, 246, 0.08) 0 2px,
				transparent 2px 40px
			),
			repeating-linear-gradient(
				60deg,
				rgba(225, 29, 116, 0.08) 0 2px,
				transparent 2px 40px
			);
		opacity: 0.3;
		pointer-events: none;
		z-index: 2;
	}
</style>
